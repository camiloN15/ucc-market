<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCCMARKET - Gestión de Productos</title>
    <link rel="stylesheet" href="styles.css">
    <script src="productos.js" defer></script>
    <script src="admin.js" defer></script>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="Logo.png" alt="UCC MARKET" id="logo-img">
                <span class="logo-text">UCCMARKET</span>
            </div>
            <div class="nav-links">
                <a href="index.html">Inicio</a>
                <a href="carrito.html">Carrito</a>
                <span id="userStatus" class="user-status"></span>
                <a href="login.html">Salir</a>
            </div>
        </nav>
    </header>

    <script>
    (function(){
        var statusEl = document.getElementById('userStatus');
        var authLink = document.querySelector('.nav-links a[href="login.html"]');
        try {
            var user = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (statusEl) {
                var text = user ? 'Sesión: ' + (user.name || user.email) : '';
                statusEl.textContent = text;
                if (user && user.isAdmin) {
                    statusEl.style.cursor = 'pointer';
                    statusEl.title = 'Ir al panel de administración';
                    statusEl.addEventListener('click', function(){ window.location.href = 'admin.html'; });
                }
            }
            if (authLink) {
                authLink.textContent = 'Salir';
                authLink.addEventListener('click', function(e){
                    e.preventDefault();
                    localStorage.removeItem('currentUser');
                    window.location.href = 'login.html';
                });
            }
        } catch(e) {}
    })();
    </script>

    <main class="admin-main">
        <section class="admin-panel">
            <h1>Gestión de Productos</h1>
            <div class="demo-banner" style="margin-bottom:12px;padding:10px;border-radius:8px;background:#eaf6ff;border:1px solid #cfeeff;color:#003366;">
                <strong>Modo demo:</strong> Estás viendo la interfaz de administración sin iniciar sesión. Los cambios se guardan en localStorage del navegador.
            </div>
            <div class="admin-grid">
                <div class="admin-form-card">
                    <h2>Agregar/Editar producto</h2>
                    <form id="productForm">
                        <input type="hidden" id="productId">
                        <label>Nombre del producto</label>
                        <input type="text" id="productName" required>

                        <label>Cantidad disponible</label>
                        <input type="number" id="productQuantity" min="0" value="0" required>

                        <label>Precio unitario (en COP, sin separadores)</label>
                        <input type="number" id="productPrice" min="0" value="0" required>

                        <label>Categoría</label>
                        <select id="productCategory">
                            <option value="laptops">Laptops</option>
                            <option value="perifericos">Periféricos</option>
                            <option value="monitores">Monitores</option>
                        </select>

                        <label>URL imagen (principal)</label>
                        <input type="url" id="productImage" placeholder="https://...">

                        <label>Descripción breve</label>
                        <textarea id="productDescription"></textarea>

                        <div class="form-actions">
                            <button type="submit" id="saveProduct">Guardar producto</button>
                            <button type="button" id="cancelEdit">Cancelar</button>
                        </div>
                    </form>
                </div>

                <div class="admin-stats-card">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="statTotalProducts">0</h3>
                            <p>Total de productos registrados</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="statTotalInventory">0</h3>
                            <p>Cantidad total en inventario</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="statCategories">0</h3>
                            <p>Categorías activas</p>
                        </div>
                    </div>

                    <div class="product-table-card">
                        <h2>Inventario</h2>
                        <input type="text" id="searchInput" placeholder="Buscar por nombre...">
                        <table id="productsTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Cantidad</th>
                                    <th>Precio</th>
                                    <th>Categoría</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- filas dinámicas -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-bottom">
            <p>&copy; 2025 UCCMARKET. Todos los derechos reservados.</p>
        </div>
    </footer>
</body>
</html>